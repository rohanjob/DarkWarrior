@{
    ViewData["Title"] = "Hunter Login - Darksite";
}

<!DOCTYPE html>
<html lang="en" class="dark-theme">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="~/css/site.css">
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animated"></div>
    <div id="particles-bg"></div>

    <!-- Navigation -->
    <header>
        <nav class="container">
            <a href="@Url.Action("Index", "Home")" class="logo">DARKSITE</a>
            <ul class="nav-links">
                <li><a href="@Url.Action("Index", "Home")">Home</a></li>
                <li><a href="@Url.Action("About", "Home")">About</a></li>
                <li><a href="@Url.Action("Register", "Home")">Register</a></li>
            </ul>
        </nav>
    </header>

    <!-- Login Section -->
    <section class="container" style="min-height: 80vh; display: flex; align-items: center; justify-content: center; padding: 2rem 0;">
        <div style="max-width: 500px; width: 100%;">
            <div class="terminal">
                <h1 class="text-center mb-2 glitch">HUNTER LOGIN</h1>
                <p class="text-center text-secondary mono mb-3">Access Restricted - Authentication Required</p>

                <!-- Login Form -->
                <form id="loginForm" style="margin-top: 2rem;">
                    <div class="form-group">
                        <label for="email" class="mono">
                            <span class="text-primary">‚ö°</span> EMAIL ADDRESS
                        </label>
                        <input 
                            type="email" 
                            class="form-control mono" 
                            id="email" 
                            name="email" 
                            placeholder="hunter@darksite.com"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="password" class="mono">
                            <span class="text-primary">üîê</span> PASSWORD
                        </label>
                        <input 
                            type="password" 
                            class="form-control mono" 
                            id="password" 
                            name="password" 
                            placeholder="Enter your secure password"
                            required
                        >
                    </div>

                    <!-- Error Message Display -->
                    <div id="errorMessage" style="display: none; padding: 1rem; background: rgba(255,0,64,0.1); border: 1px solid var(--accent-danger); border-radius: 5px; margin-bottom: 1rem;">
                        <p class="text-danger mono" id="errorText"></p>
                    </div>

                    <!-- Success Message Display -->
                    <div id="successMessage" style="display: none; padding: 1rem; background: rgba(0,255,65,0.1); border: 1px solid var(--accent-primary); border-radius: 5px; margin-bottom: 1rem;">
                        <p class="text-primary mono">‚úì Authentication successful! Redirecting...</p>
                    </div>

                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <span id="loginButtonText">‚ö° AUTHENTICATE</span>
                    </button>
                </form>

                <!-- Demo Credentials -->
                <div style="margin-top: 2rem; padding: 1rem; background: rgba(0,212,255,0.05); border: 1px solid rgba(0,212,255,0.2); border-radius: 5px;">
                    <p class="text-secondary mono" style="font-size: 0.9rem; margin-bottom: 0.5rem;">
                        üìå DEMO CREDENTIALS (Study Purpose Only)
                    </p>
                    <p class="text-muted mono" style="font-size: 0.85rem; margin: 0;">
                        Email: <span class="text-primary">admin@darksite.com</span><br>
                        Password: <span class="text-primary">password123</span>
                    </p>
                </div>

                <!-- Links -->
                <div style="margin-top: 2rem; text-align: center;">
                    <p class="text-secondary mono">
                        Don't have an account? 
                        <a href="@Url.Action("Register", "Home")" class="text-primary" style="text-decoration: none;">
                            Register Here ‚Üí
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer style="background: rgba(18,18,26,0.9); padding: 2rem; text-align: center; border-top: 2px solid var(--accent-primary);">
        <p class="text-muted mono">
            ‚ö†Ô∏è STUDY PURPOSE ONLY - FICTIONAL PLATFORM<br>
            DARKSITE &copy; 2025 | DevOps Learning Project
        </p>
    </footer>

    <!-- Load JavaScript -->
    <script src="~/js/scroll-effects.js"></script>
    <script src="~/js/spider.js"></script>
    <script src="~/js/api-client.js"></script>
    
    <script>
        // Login form handler
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('errorMessage');
            const successDiv = document.getElementById('successMessage');
            const buttonText = document.getElementById('loginButtonText');
            
            // Hide previous messages
            errorDiv.style.display = 'none';
            successDiv.style.display = 'none';
            
            // Show loading state
            buttonText.textContent = '‚è≥ AUTHENTICATING...';
            
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Store hunter info
                    localStorage.setItem('hunter', JSON.stringify(data.hunter));
                    
                    // Show success
                    successDiv.style.display = 'block';
                    
                    // Redirect to bounty board
                    setTimeout(() => {
                        window.location.href = '@Url.Action("Board", "Bounty")';
                    }, 1500);
                } else {
                    // Show error
                    document.getElementById('errorText').textContent = '‚ùå ' + data.message;
                    errorDiv.style.display = 'block';
                    buttonText.textContent = '‚ö° AUTHENTICATE';
                }
            } catch (error) {
                console.error('Login error:', error);
                document.getElementById('errorText').textContent = '‚ùå Connection error. API may not be running.';
                errorDiv.style.display = 'block';
                buttonText.textContent = '‚ö° AUTHENTICATE';
            }
        });
    </script>
</body>
</html>
